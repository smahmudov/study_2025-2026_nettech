---
## Front matter
title: "Отчёт по лабораторной работе 3"
subtitle: "Анализ трафика в Wireshark"
author: "Суннатилло Махмудов"

## Generic otions
lang: ru-RU
toc-title: "Содержание"

## Bibliography
bibliography: bib/cite.bib
csl: pandoc/csl/gost-r-7-0-5-2008-numeric.csl

## Pdf output format
toc: true # Table of contents
toc-depth: 2
lof: true # List of figures
lot: true # List of tables
fontsize: 12pt
linestretch: 1.5
papersize: a
documentclass: scrreprt
## I18n polyglossia
polyglossia-lang:
  name: russian
  options:
	- spelling=modern
	- babelshorthands=true
polyglossia-otherlangs:
  name: english
## I18n babel
babel-lang: russian
babel-otherlangs: english
## Fonts
mainfont: IBM Plex Serif
romanfont: IBM Plex Serif
sansfont: IBM Plex Sans
monofont: IBM Plex Mono
mathfont: STIX Two Math
mainfontoptions: Ligatures=Common,Ligatures=TeX,Scale=0.94
romanfontoptions: Ligatures=Common,Ligatures=TeX,Scale=0.94
sansfontoptions: Ligatures=Common,Ligatures=TeX,Scale=MatchLowercase,Scale=0.94
monofontoptions: Scale=MatchLowercase,Scale=0.94,FakeStretch=0.9
mathfontoptions:
## Biblatex
biblatex: true
biblio-style: "gost-numeric"
biblatexoptions:
  - parentracker=true
  - backend=biber
  - hyperref=auto
  - language=auto
  - autolang=other*
  - citestyle=gost-numeric
## Pandoc-crossref LaTeX customization
figureTitle: "Рис."
tableTitle: "Таблица"
listingTitle: "Листинг"
lofTitle: "Список иллюстраций"
lotTitle: "Список таблиц"
lolTitle: "Листинги"
## Misc options
indent: true
header-includes:
  - \usepackage{indentfirst}
  - \usepackage{float} # keep figures where there are in the text
  - \floatplacement{figure}{H} # keep figures where there are in the text
---

# Цель работы

Изучение посредством Wireshark кадров Ethernet, анализ PDU протоколов транспортного и прикладного уровней стека TCP/IP.

# Теоретические сведения по работе

Компьютерные сети представляют собой совокупность узлов, объединённых для обмена данными по определённым правилам — протоколам. Для организации взаимодействия используется многоуровневая модель **OSI**, где каждый уровень отвечает за свою часть передачи данных.

**MAC-адресация** применяется на канальном уровне и позволяет однозначно идентифицировать сетевой интерфейс.  
MAC-адрес состоит из 48 бит (6 байт), представленных в шестнадцатеричной системе. Первые 24 бита (OUI) определяют производителя устройства, а оставшиеся 24 бита — уникальный идентификатор интерфейса.  
MAC-адреса бывают:
- **Уникальные (unicast)** — для обмена между двумя устройствами;  
- **Групповые (multicast/broadcast)** — для передачи сразу нескольким получателям;  
- **Глобально администрируемые** (назначены производителем);  
- **Локально администрируемые** (назначены пользователем или администратором).

**ARP (Address Resolution Protocol)** используется для преобразования IP-адреса в MAC-адрес, необходимый для доставки пакета в пределах локальной сети.  
Запрос ARP (Who has …?) рассылается всем узлам, а ответ содержит соответствующий MAC-адрес.

**ICMP (Internet Control Message Protocol)** служит для передачи диагностических и служебных сообщений. Наиболее часто используется для проверки доступности узла с помощью команд **ping** (эхо-запросы и эхо-ответы).

**TCP (Transmission Control Protocol)** работает на транспортном уровне и обеспечивает надёжную доставку данных. Характерной особенностью является процедура установления соединения — *трёхстороннее рукопожатие (three-way handshake)*, включающее обмен сегментами SYN, SYN+ACK и ACK.

**UDP (User Datagram Protocol)** — более простой транспортный протокол, не требующий установления соединения. Он используется для приложений, где важна скорость, а не надёжность (например, DNS-запросы, потоковое видео).

**QUIC (Quick UDP Internet Connections)** — современный транспортный протокол, работающий поверх UDP. Он сочетает преимущества UDP (скорость) и TCP (надёжность), а также использует встроенное шифрование на основе TLS 1.3.

**Wireshark** — это инструмент анализа сетевого трафика, позволяющий исследовать кадры и пакеты на разных уровнях модели OSI. С его помощью можно детально рассматривать заголовки протоколов (Ethernet II, ARP, ICMP, TCP, UDP, QUIC) и отслеживать логику обмена данными.

# Выполнение лабораторной работы

## MAC-адресация

1. С помощью команды **ipconfig** в ОС Windows была выведена информация о текущих сетевых соединениях.  
   На скриншоте отображены параметры двух сетевых адаптеров, включая IPv4-адрес, маску подсети и основной шлюз.  

   ![Вывод команды ipconfig](01.png){ #fig:001 width=80% }

2. Для получения более подробной информации о сетевом интерфейсе была использована команда:  

   ipconfig /all

   В результате отобразились дополнительные параметры:  
   – **Описание адаптера** (Realtek Gaming 2.5GbE Family Controller);  
   – **Физический адрес (MAC)**: `10-FF-E0-21-D6-B4`;  
   – DHCP и автоконфигурация;  
   – Адресация DNS и DHCP-сервера.  

   ![Вывод команды ipconfig /all](02.png){ #fig:002 width=80% }

3. Определение структуры MAC-адреса:  

   MAC-адрес устройства:  
   10-FF-E0-21-D6-B4  

   В шестнадцатеричной записи:  
   10:FF:E0:21:D6:B4  

   - Первые 3 октета (**10:FF:E0**) — **OUI (Organizationally Unique Identifier)**, определяющий производителя сетевого адаптера (в данном случае — Realtek).  
   - Последние 3 октета (**21:D6:B4**) — уникальный идентификатор устройства внутри организации-производителя.  
   - Данный адрес является **индивидуальным (unicast)**, так как первый байт (0x10) имеет младший бит равный **0**.  
   - Адрес является **глобально администрируемым**, так как второй младший бит первого байта равен **0**.  

## Анализ кадров канального уровня в Wireshark

1. На устройство был установлен анализатор сетевого трафика **Wireshark**.  
   После запуска программы был выбран активный сетевой интерфейс, начался захват пакетов.  

2. В консоли Windows с помощью команды **ipconfig** были определены параметры сетевого подключения:  
   – IPv4-адрес устройства: `192.168.1.10`  
   – Маска подсети: `255.255.255.0`  
   – Шлюз по умолчанию: `192.168.1.1`  

3. С помощью команды **ping 192.168.1.1** был выполнен обмен эхо-запросами и эхо-ответами с шлюзом по умолчанию.  

4. В программе Wireshark был установлен фильтр **arp or icmp**, что позволило отобразить только пакеты ARP и ICMP, сгенерированные командой ping.  

   ![Фильтрация ARP и ICMP пакетов](03.png){ #fig:003 width=80% }
   

5. Анализ ICMP-пакетов:  

   **Эхо-запрос (Echo Request):**  
   - Длина кадра: 74 байта  
   - Тип Ethernet: **Ethernet II**  
   - MAC-адрес источника: `10:ff:e0:21:d6:b4`  
   - MAC-адрес шлюза (назначения): `c8:7f:54:78:b6:f2`  
   - Тип адресов: индивидуальные, глобально администрируемые  

   **Эхо-ответ (Echo Reply):**  
   - Длина кадра: 74 байта  
   - Тип Ethernet: **Ethernet II**  
   - MAC-адрес источника: `c8:7f:54:78:b6:f2`  
   - MAC-адрес назначения: `10:ff:e0:21:d6:b4`  
   - Тип адресов: индивидуальные, глобально администрируемые  

   ![Анализ ICMP эхо-запроса](04.png){ #fig:004 width=80% }

6. Анализ ARP-кадров:  
   – Запрос: *Who has 192.168.1.10? Tell 192.168.1.1*  
   – Ответ: *192.168.1.10 is at 10:ff:e0:21:d6:b4*  
   – В кадрах Ethernet II определены MAC-адреса источника и назначения.  

7. Для анализа внешнего взаимодействия был выполнен ping доменного имени **ya.ru**.  
   В процессе обмена пакетами ICMP в Wireshark были зафиксированы как ARP-запросы, так и ICMP-запросы/ответы.  

   ![Ping ya.ru](05.png){ #fig:005 width=80% }

   ![Анализ ICMP-запроса к внешнему ресурсу](06.png){ #fig:006 width=80% }
   
  ## Анализ протоколов транспортного уровня в Wireshark

1. На устройстве был запущен анализатор трафика **Wireshark**.  
   Для захвата пакетов был выбран активный сетевой интерфейс.  

2. В браузере был открыт сайт **CERN** (http://info.cern.ch/), работающий по протоколу **HTTP**.  
   Для генерации большего количества пакетов были выполнены переходы по ссылкам.  

3. В Wireshark был применён фильтр **http**.  
   На скриншоте отображены пакеты, относящиеся к HTTP-запросам и ответам:  

   – Пакет **GET / HTTP/1.1** отправлен от клиента `192.168.1.10` к серверу `188.184.67.127`.  
   – В ответ сервер передал несколько кадров с кодом **200 OK** и данными HTML-страниц.  
   – Анализ TCP-полей показал:  
     - Исходный порт клиента: `50094`  
     - Порт назначения сервера: `80`  
     - Используется управление соединением через номера последовательности (Sequence) и подтверждения (ACK).  

   ![HTTP-запросы и ответы](08.png){ #fig:008 width=80% }

4. Далее был применён фильтр **dns**.  
   На скриншоте видно взаимодействие клиента (`192.168.1.10`) с DNS-сервером (`192.168.1.1`):  

   – Отправлялись стандартные **DNS-запросы** (A и HTTPS) к домену `slacvx.slac.stanford.edu`.  
   – Сервер возвращал ответы: как положительные (с IP-адресами), так и отрицательные (`No such name`).  
   – Транспортным протоколом является **UDP**, порт источника динамический (например `61235`), порт назначения фиксированный — `53`.  

   ![DNS-запросы и ответы](09.png){ #fig:009 width=80% }

5. Для анализа протокола **QUIC** в Wireshark был применён фильтр **quic**.  
   На скриншоте видны зашифрованные обмены с сервером `173.194.221.100`:  

   – Используются пакеты UDP с портом назначения `443`.  
   – На этапе установления соединения был зафиксирован кадр **QUIC Handshake** с идентификатором соединения (DCID).  
   – Дальнейшие пакеты передавали **Protected Payload**, так как QUIC обеспечивает встроенное шифрование данных.  

   ![QUIC-трафик](10.png){ #fig:010 width=80% }


## Анализ handshake протокола TCP в Wireshark

1. На устройстве был запущен анализатор **Wireshark** и выбран активный сетевой интерфейс для захвата пакетов.  

2. Для генерации TCP-трафика было установлено соединение с веб-сайтом по протоколу **HTTP**.  

3. В Wireshark был зафиксирован процесс установки TCP-соединения (трёхстороннее рукопожатие – *three-way handshake*).  
   Этот процесс включает следующие шаги:  
   - Клиент отправляет сегмент **SYN** с начальным номером последовательности (Sequence Number).  
   - Сервер отвечает сегментом **SYN, ACK**, подтверждая получение первого сегмента и предлагая свой номер последовательности.  
   - Клиент подтверждает сегментом **ACK**, устанавливая соединение.  

   ![Фиксация TCP пакетов](11.png){ #fig:011 width=80% }

4. Для анализа эволюции значений полей TCP был использован инструмент **Статистика → Поток**.  
   На диаграмме потоков виден обмен пакетами между клиентом `192.168.1.10` и сервером.  
   – Первый пакет (SYN) содержит `Seq = 0`.  
   – Ответ сервера (SYN, ACK) указывает собственный `Seq = 0`, а также подтверждает номер клиента `Ack = 1`.  
   – Третий пакет (ACK) подтверждает данные сервера, устанавливая `Ack = 1`.  

   ![График TCP потока 1](12.png){ #fig:012 width=80% }

5. На другом примере TCP-потока можно наблюдать детализацию:  
   – После установки соединения начинают передаваться пакеты с полезной нагрузкой (PSH, ACK).  
   – Для каждого сегмента фиксируются номера последовательности и подтверждения.  
   – На графике также видны этапы завершения соединения (FIN, ACK и RST).  

   ![График TCP потока 2](13.png){ #fig:013 width=80% }


# Вывод

В ходе лабораторных работ были изучены и проанализированы основные механизмы работы сетевых протоколов и сервисов.  
С помощью утилиты **ipconfig** были определены параметры сетевых интерфейсов и проведён анализ структуры **MAC-адресов**.  
С использованием анализатора трафика **Wireshark** были исследованы кадры уровней **ARP** и **ICMP**, подтверждена работа протокола разрешения адресов и обмен эхо-запросами/ответами.  
На транспортном уровне были проанализированы протоколы **TCP**, **UDP** и **QUIC**, определены их особенности в передаче данных и работе с соединениями.  
Отдельное внимание уделено механизму установления соединения по TCP (**three-way handshake**), который был подробно изучен и визуализирован средствами Wireshark.  